<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: js/ui/Menus.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: js/ui/Menus.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const Logger = require('../utils/Logger');
require('../../css/player.less');
/**
 *  Class player in whinch the player is implemented
 */
class Menus {
  constructor(mainVideo, subsBtnId, audiosBtnId, MenusContDivId) {
    this.logger = new Logger(this);
    this.video = mainVideo;
    this.mediaPlayer = null;
    this.subtitlesBtnId = subsBtnId;
    this.audsBtnId = audiosBtnId;
    this.subsMenuListId = `smml${this.subtitlesBtnId}`;
    this.audsMenuListId = `amml${audiosBtnId}`;
    this.MenusContainerDivId = MenusContDivId;
    this.menusDiv = document.getElementById(this.MenusContainerDivId);
    this.SubsExist = false;
    this.subsMenuDiv = null;
    this.subsList = null;
    this.audsExist = false;
    this.audsMenuDiv = null;
    this.audsList = null;
  }

  /**
     *Hide Menu Subtitles
     */
  HideMenuSubs() {
    if ((this.SubsExist === true)
            &amp;&amp; (this.subsMenuDiv.classList.contains('fj-hide') === false)) {
      this.subsMenuDiv.classList.add('fj-hide');
    }
  }

  /**
     * Hide Menu Audios
     */
  HideMenusAuds() {
    if ((this.audsExist === true)
            &amp;&amp; (this.audsMenuDiv.classList.contains('fj-hide') === false)) {
      this.audsMenuDiv.classList.add('fj-hide');
    }
  }

  /**
     *
     * @param {*Funtion Callback used to activate item of list
     */
  activate(item, isItSubs) {
    let i; let litem; let k; let
      list;
    if (isItSubs === true) {
      list = this.subsList;
    } else {
      list = this.audsList;
    }
    const index = Array.prototype.indexOf.call(list.childNodes, item);
    const tindex = item.getAttribute('index');
    this.logger.info('clicked is  selected @ index ', index, ' text index ', tindex);

    if (isItSubs === true) {
      this.mediaPlayer.setTextTrack(tindex);
    } else {
      this.mediaPlayer.setAudioLang(tindex);
    }

    for (i = 0; i &lt; list.children.length; i += 1) {
      litem = list.children[i];
      k = litem.getAttribute('index');
      if (tindex === k) {
        litem.classList.remove('subtitles-menu-item');
        litem.classList.add('subtitles-menu-item-actif');
        this.logger.log('Setting item @  ', i);
      } else {
        litem.classList.remove('subtitles-menu-item-actif');
        litem.classList.add('subtitles-menu-item');
        this.logger.log('Unsetting item @  ', i);
      }
    }
    if (isItSubs === true) {
      this.HideMenuSubs();
    } else {
      this.HideMenusAuds();
    }
  }

  /**
     * Event CALLBACK ; called on menu Click
     */
  onshowHideMenu(menuContainer, element, ev) {
    const rectV = this.video.getBoundingClientRect();
    const rect = element.getBoundingClientRect();
    if (menuContainer.classList.contains('fj-hide')) {
      this.logger.warn('setting left @', (rect.right - ev.pageX));
      this.logger.warn('setting left @', (rect.left - ev.pageX));
      this.menuContainer.style.left = ev.pageX - rectV.left - rect.width;
      this.menuContainer.classList.remove('fj-hide');
    } else {
      menuContainer.classList.add('fj-hide');
    }
  }

  /**
     * Used to Hide menu
     */
  HideMenus() {
    this.HideMenuSubs();
    this.HideMenusAuds();
  }

  /**
     *
     * @param {*} playerMedia
     */
  SetupSubs(playerMedia) {
    this.logger.info('Calling for setup Subs !!!');
    let subtitlesBtn = null;
    let i = 0;
    let activated = false;
    let item = null;
    this.mediaPlayer = playerMedia;
    const textTracks = this.mediaPlayer.getTextTracks();
    this.SubsExist = false;

    this.logger.info(' Trying to setup menu subs , text tracks length : ', textTracks);
    // check if exist
    if ((!textTracks) || (textTracks.length &lt;= 0)) {
      this.SubsExist = false;
      this.logger.log(' Subs Menu not created !');
      return false;
    }
    // check if this.video contains subs  exist
    for (i = 0; i &lt; textTracks.length; i += 1) {
      this.logger.debug(' @ text track number  ', i, ' and it type is ',
        textTracks[i].kind);
      if ((textTracks[i].kind === 'captions')
                || (textTracks[i].kind === 'subtitle')
                || (textTracks[i].kind === 'subtitles')) {
        this.SubsExist = true;
        break;
      }
    }
    if (this.SubsExist === false) {
      this.logger.info(' Subs Menu Not created !! ');
      return this.SubsExist;
    }
    // Setting btn
    subtitlesBtn = document.getElementById(this.subtitlesBtnId);
    this.logger.info('Setting the btn ', subtitlesBtn, ' from id ', this.subtitlesBtnId);
    // this.video array
    this.subsList = document.getElementById(this.subsMenuListId);
    // clear old
    if (this.subsList !== null) {
      while (this.subsList.firstChild) {
        this.subsList.removeChild(this.subsList.firstChild);
      }
    } else {
      this.subsMenuDiv = document.createElement('div');
      this.subsMenuDiv.classList.add('settingMenuDiv');
      this.subsMenuDiv.classList.add('fj-hide');
      this.subsMenuDiv.innerHTML = `${'&lt;div class="fj-list-title"> Soutitres &lt;/div> '
                + '&lt;ul class="fj-list"  id="'}${this.subsMenuListId}" >`
                + '&lt;/ul>';
      this.menusDiv.appendChild(this.subsMenuDiv);
      // Add events for subtitles button
      subtitlesBtn.addEventListener('click', (ev) => {
        this.onshowHideMenu(this.subsMenuDiv, this, ev);
      });
      //  subs list
      this.subsList = document.getElementById(this.subsMenuListId);
    }
    // loop
    for (i = 0; i &lt; textTracks.length; i += 1) {
      if ((textTracks[i].kind === 'captions')
                || (textTracks[i].kind === 'subtitle')
                || (textTracks[i].kind === 'subtitles')) {
        item = document.createElement('li');
        if (this.mediaPlayer.isTextTrackEnabled(i) === true) {
          item.classList.add('subtitles-menu-item-actif');
          activated = true;
        } else {
          item.classList.add('subtitles-menu-item');
        }
        item.setAttribute('index', i);
        item.innerHTML = this.mediaPlayer.getTextTrackLabel(i);
        this.subsList.appendChild(item);
        item.addEventListener('click', () => {
          this.activate(this, true);
        });
        this.logger.debug('Setting Subs List @ ', i, ' item is ', item);
      }
    }

    // off item
    item = document.createElement('li');
    if (activated === false) {
      item.classList.add('subtitles-menu-item-actif');
    } else {
      item.classList.add('subtitles-menu-item');
    }
    item.setAttribute('index', -1);
    item.innerHTML = 'off';
    this.subsList.appendChild(item);
    item.addEventListener('click', () => {
      this.activate(this);
    });
    this.logger.log('Setting Subs List @ ', -1, ' item is ', item);

    this.logger.log(' Subs Menu  created !! ', this.subsMenuDiv);
    return this.SubsExist;
  }

  /**
     * Setting Auds menu and cbx
     */
  SetupAuds(playerMedia) {
    this.logger.info('Calling for setup Auds !!!');
    let audsBtn = null;
    let i = 0;
    let item = null;
    this.mediaPlayer = playerMedia;
    const audioTracks = this.mediaPlayer.getAudioLanguages();
    this.audsExist = false;
    this.logger.info(' Trying to setup menu Auds , text tracks length : ', audioTracks);

    // check if exist
    if ((!audioTracks) || (audioTracks.length &lt;= 1)) {
      this.audsExist = false;
      this.logger.log(' Audio Menu not created !');
      return false;
    }
    // Setting inner of btn div
    audsBtn = document.getElementById(this.audsBtnId);
    this.logger.info('Setting the btn ', audsBtn, ' from id ', this.audsBtnId);
    // this.video array
    this.audsList = document.getElementById(this.audsMenuListId);
    // clear old
    if (this.audsList !== null) {
      while (this.audsList.firstChild) {
        this.audsList.removeChild(this.audsList.firstChild);
      }
    } else {
      this.audsMenuDiv = document.createElement('div');
      this.audsMenuDiv.classList.add('settingMenuDiv');
      this.audsMenuDiv.classList.add('fj-hide');
      this.audsMenuDiv.innerHTML = `${'&lt;div class="fj-list-title"> Audios &lt;/div> '
                + '&lt;ul class="fj-list"  id="'}${this.audsMenuListId}" >`
                + '&lt;/ul>';
      this.menusDiv.appendChild(this.audsMenuDiv);
      // Add events for audios button
      audsBtn.addEventListener('click', (ev) => {
        this.onshowHideMenu(this.audsMenuDiv, this, ev);
      });
      //  audios list
      this.audsList = document.getElementById(this.audsMenuListId);
    }

    for (i = 0; i &lt; audioTracks.length; i += 1) {
      item = document.createElement('li');
      if (this.mediaPlayer.isAudioLangEnabled(i) === true) {
        item.classList.add('subtitles-menu-item-actif');
      } else {
        item.classList.add('subtitles-menu-item');
      }

      item.setAttribute('index', i);
      item.innerHTML = this.mediaPlayer.getAudioLangLabel(i);
      this.audsList.appendChild(item);
      item.addEventListener('click', () => {
        this.activate(this, false);
      });
    }

    this.logger.debug(' Audio Menu created !', audioTracks.length, '! ', this.audsList);
    return this.audsExist;
  }
}

module.exports = Menus;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-AdsManager.html">AdsManager</a></li><li><a href="module-Constants.html">Constants</a></li><li><a href="module-Eventing.html">Eventing</a></li><li><a href="module-FjseAuthz.html">FjseAuthz</a></li><li><a href="module-Logger.html">Logger</a></li><li><a href="module-Overlay.html">Overlay</a></li><li><a href="module-PlayerMedia.html">PlayerMedia</a></li><li><a href="module-playerTemplate.html">playerTemplate</a></li><li><a href="module-PlayerUi.html">PlayerUi</a></li><li><a href="module-Thumbs.html">Thumbs</a></li></ul><h3>Classes</h3><ul><li><a href="Menus.html">Menus</a></li><li><a href="Player.html">Player</a></li><li><a href="global.html#Playlist">Playlist</a></li><li><a href="Version.html">Version</a></li></ul><h3>Global</h3><ul><li><a href="global.html#IsoLangs">IsoLangs</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Wed Jan 05 2022 13:46:00 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
